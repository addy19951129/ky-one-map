!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("kyOneMap",[],t):"object"==typeof exports?exports.kyOneMap=t():e.kyOneMap=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=1)}([function(e,t,r){"use strict";var n=r(9),o=(r.n(n),function(){function e(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}());t.a={name:"ky-map",data:function(){return{map:{},mapView:{},oneMap:{},clickMap:new Map,mouseoverMap:new Map,varSetTimeout:""}},created:function(){var e=this,t=this,r={url:"http://118.89.18.66/arcgis/arcgis_js_v417_api/arcgis_js_api/library/4.17/init.js",css:"http://118.89.18.66/arcgis/arcgis_js_v417_api/arcgis_js_api/library/4.17/esri/css/main.css"};Object(n.loadModules)(["esri/Map","esri/views/MapView","esri/layers/WebTileLayer","esri/layers/FeatureLayer","esri/layers/TileLayer","esri/layers/MapImageLayer","esri/layers/VectorTileLayer","esri/layers/GeoJSONLayer","esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/symbols/TextSymbol","esri/tasks/IdentifyTask","esri/tasks/support/IdentifyParameters","esri/geometry/geometryEngine","esri/tasks/support/Query"],r,{css:!0}).then(function(r){var n=o(r,17),i=n[0],a=n[1],s=n[2],u=n[3],l=(n[4],n[5]),c=n[6],d=(n[7],n[8]),p=n[9],f=n[10],m=(n[11],n[12],n[13]),y=n[14],v=n[15],h=n[16],w="5630174b76350ef58bc5a615a890a46a";t.map=new i({}),t.mapView=new a({container:e.$el,map:t.map,center:[117.938,26.127],zoom:8});var g=new s({urlTemplate:"http://{subDomain}.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=img&STYLE=default&FORMAT=tiles&TILEMATRIXSET=w&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}&tk="+w,subDomains:["t0","t1","t2","t3","t4","t5","t6","t7"]}),b=new s({urlTemplate:"http://{subDomain}.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=cia&STYLE=default&FORMAT=tiles&TILEMATRIXSET=w&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}&tk="+w,subDomains:["t0","t1","t2","t3","t4","t5","t6","t7"]}),M=new l({url:"http://120.79.6.214:6080/arcgis/rest/services/SXYfjxzjx/MapServer",sublayers:[{id:3,visible:!1},{id:2,visible:!0},{id:1,visible:!1},{id:0,visible:!1},{id:4,visible:!1}]});t.oneMap={zoom:"7",addLayer:function(e,t){return t=Object.assign({url:"",opacity:1,id:Math.random().toString(36).substr(4),outFields:["*"]},t||{}),this.addLayerMethod.get(e)(t)},removeLayer:function(e){var r=t.map.findLayerById(e);t.clickMap.has(e)&&t.clickMap.delete(e),t.mouseoverMap.has(e)&&t.mouseoverMap.delete(e),t.map.remove(r)},addLayerMethod:new Map([["MapImageLayer",function(e){var r=new l(e);return e.layerIndex?t.map.add(r,e.layerIndex):t.map.add(r),e.onClick&&e.onClick,e.onMouseover&&"function"==typeof e.onMouseover&&t.mouseoverMap.set(e.id,e.onMouseover),e.toFullExtent&&r.when(function(){r.fullExtent.spatialReference={wkid:4326},t.mapview.goTo(r.fullExtent.expand(1.7))}),r}],["FeatureLayer",function(e){var r=new u(e);return e.layerIndex?t.map.add(r,e.layerIndex):t.map.add(r),e.onClick&&"function"==typeof e.onClick&&t.clickMap.set(e.id,e.onClick),e.onMouseover&&"function"==typeof e.onMouseover&&t.mouseoverMap.set(e.id,e.onMouseover),r}],["PointLayer",function(e){for(var r=new d({opacity:1,id:e.id}),n=e.lonField?e.lonField:"lon",o=e.latField?e.latField:"lat",i=0;i<e.data.length;i++){var a=new f({spatialReference:4326,x:e.data[i][n],y:e.data[i][o]}),s={type:"simple-marker",color:[226,119,40],outline:{color:[255,255,255],width:2}};if(e.data[i].symbol?s=t.oneMap.symbol(e.data[i].symbol):e.symbol&&(s=t.oneMap.symbol(e.symbol)),e.data[i].label){var u=new f({spatialReference:4326,x:e.data[i][n],y:e.data[i][o]}),l=t.oneMap.symbol(e.data[i].label),c=new p(u,l);r.add(c)}var m=new p(a,s,e.data[i]);r.add(m)}return e.layerIndex?t.map.add(r,e.layerIndex):t.map.add(r),e.onClick&&"function"==typeof e.onClick&&t.clickMap.set(e.id,e.onClick),e.onMouseover&&"function"==typeof e.onMouseover&&t.mouseoverMap.set(e.id,e.onMouseover),r}],["simplePointLayer",function(e){return new f({spatialReference:4326,x:e.lon,y:e.lat})}],["VectorTileLayer",function(e){var r=new c(e);return e.layerIndex?t.map.add(r,e.layerIndex):t.map.add(r),r}]]),symbol:function(e){return this.symbolMethod.get(e.type)(e)},symbolMethod:new Map([["PictureMarkerSymbol",function(e){return{type:"picture-marker",url:e.url,width:e.width,height:e.height}}],["TextSymbol",function(e){return{type:"text",color:"#000",haloColor:"#fff",haloSize:"2px",text:e.text,xoffset:e.offsetX?e.offsetX:3,yoffset:e.offsetY?e.offsetY:-20,font:{size:e.fontSize?e.fontSize:10,family:"Josefin Slab",weight:"bold"}}}],["SimpleMarkerSymbol",function(){return{type:"simple",symbol:{type:"simple-marker",size:3,color:"white",style:"circle",outline:{width:.5,color:"gray"}}}}],["SimpleFillSymbol",function(){return{type:"simple",symbol:{type:"simple-fill",style:"none",outline:{width:.5,color:"gray"}}}}],["SimpleLineSymbol",function(){return{type:"simple",symbol:{type:"simple-line",style:"none",width:.7,color:"white"}}}],["FeatureLayerPictureMarkerSymbol",function(e){return{type:"simple",symbol:{type:"picture-marker",url:e.url,width:e.width,height:e.height}}}]]),IdentifyTaskQuery:function(e,r){var n=new m(e.url),o=new y;o.tolerance=3,o.returnGeometry=!0,o.layerIds=e.layerIds,o.layerOption="top",o.width=t.mapView.width,o.height=t.mapView.height,o.geometry=e.evt.mapPoint,o.mapExtent=t.mapView.extent,n.execute(o).then(function(e){r(e.results)}).then(function(){})},createBuffer:function(e){var t=null,r=null,n=new d({opacity:1,id:e.id?e.id:Math.random().toString(36).substr(4)});"point"==e.geometryType&&(t=new f({spatialReference:4326,x:e.data.longitude,y:e.data.latitude}));var o=v.geodesicBuffer(t,e.distance,e.unit);return r=new p({geometry:o,symbol:{type:"simple-fill",color:[226,119,40,.3],outline:{width:1.5,color:[255,128,0,.5]}}}),n.add(r),map.add(n),map.reorder(n,1),n},mapServerToFeatureServer:function(e){var t=e.split("/");return t.splice(t.length-1,1),t.push("FeatureServer","0"),t.join("/")},mapImageLayerToExtent:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1=1",n=this.mapServerToFeatureServer(e),o=new u({url:n}),i=new h;i.where=r,o.queryExtent(i).then(function(e){if(0!=e.count){var r=e.extent;r.spatialReference={wkid:4326},t.mapView.goTo(r.expand(1.7))}})},mapToCenter:function(e){var r=new f({spatialReference:4326,x:e.x,y:e.y});t.mapView.goTo({target:r,zoom:e.zoom},{duration:700})},setMapZoom:function(e){t.mapView.goTo({zoom:e.zoom},{duration:700})}},t.map.add(g),t.map.add(b),t.map.add(M),t.mapView.ui.components=[],t.$store.commit("SET_ONEMAP",t.oneMap),t.$store.commit("SET_MAP",t.map),t.$store.commit("SET_MAPVIEW",t.mapView),t.$emit("done"),t.mapView.on("pointer-move",function(e){t.mapView.hitTest(e).then(function(e){if(e.results.length){var r=e.results[0];void 0!==t.mouseoverMap.get(r.graphic.layer.id)&&t.mouseoverMap.get(r.graphic.layer.id)(r)}})}),t.mapView.on("click",function(e){t.mapView.hitTest(e).then(function(e){if(e.results.length){var r=e.results[0];void 0!==t.clickMap.get(r.graphic.layer.id)&&t.clickMap.get(r.graphic.layer.id)(r)}})}),t.mapView.watch("extent",function(e){t.mapView.center.longitude,t.mapView.center.latitude,console.log(t.mapView.center.longitude),console.log(t.mapView.center.latitude)})})},mounted:function(){},beforeUnmount:function(){this.view&&this.view.destroy()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o={install:function(e,t){e.component(n.a.name,n.a)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(o),t.default=o},function(e,t,r){"use strict";function n(e){r(3)}var o=r(0),i=r(10),a=r(8),s=n,u=a(o.a,i.a,!1,s,"data-v-c8cf2010",null);t.a=u.exports},function(e,t,r){var n=r(4);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);r(6)("7bb7b7a2",n,!0,{})},function(e,t,r){t=e.exports=r(5)(!1),t.push([e.i,"#map__container[data-v-c8cf2010]{width:100%;height:calc(100vh - 140px)}",""])},function(e,t){function r(e,t){var r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var i=n(o);return[r].concat(o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"})).concat([i]).join("\n")}return[r].join("\n")}function n(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=r(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(e,t,r){function n(e){for(var t=0;t<e.length;t++){var r=e[t],n=c[r.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](r.parts[o]);for(;o<r.parts.length;o++)n.parts.push(i(r.parts[o]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(i(r.parts[o]));c[r.id]={id:r.id,refs:1,parts:a}}}}function o(){var e=document.createElement("style");return e.type="text/css",d.appendChild(e),e}function i(e){var t,r,n=document.querySelector("style["+h+'~="'+e.id+'"]');if(n){if(m)return y;n.parentNode.removeChild(n)}if(w){var i=f++;n=p||(p=o()),t=a.bind(null,n,i,!1),r=a.bind(null,n,i,!0)}else n=o(),t=s.bind(null,n),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else r()}}function a(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=g(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function s(e,t){var r=t.css,n=t.media,o=t.sourceMap;if(n&&e.setAttribute("media",n),v.ssrId&&e.setAttribute(h,t.id),o&&(r+="\n/*# sourceURL="+o.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var u="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!u)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var l=r(7),c={},d=u&&(document.head||document.getElementsByTagName("head")[0]),p=null,f=0,m=!1,y=function(){},v=null,h="data-vue-ssr-id",w="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(e,t,r,o){m=r,v=o||{};var i=l(e,t);return n(i),function(t){for(var r=[],o=0;o<i.length;o++){var a=i[o],s=c[a.id];s.refs--,r.push(s)}t?(i=l(e,t),n(i)):i=[];for(var o=0;o<r.length;o++){var s=r[o];if(0===s.refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete c[s.id]}}}};var g=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports=function(e,t){for(var r=[],n={},o=0;o<t.length;o++){var i=t[o],a=i[0],s=i[1],u=i[2],l=i[3],c={id:e+":"+o,css:s,media:u,sourceMap:l};n[a]?n[a].parts.push(c):r.push(n[a]={id:a,parts:[c]})}return r}},function(e,t){e.exports=function(e,t,r,n,o,i){var a,s=e=e||{},u=typeof e.default;"object"!==u&&"function"!==u||(a=e,s=e.default);var l="function"==typeof s?s.options:s;t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId=o);var c;if(i?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},l._ssrRegister=c):n&&(c=n),c){var d=l.functional,p=d?l.render:l.beforeCreate;d?(l._injectStyles=c,l.render=function(e,t){return c.call(t),p(e,t)}):l.beforeCreate=p?[].concat(p,c):[c]}return{esModule:a,exports:s,options:l}}},function(e,t,r){!function(e,r){r(t)}(0,function(e){"use strict";function t(e){if(e.toLowerCase()===M)return M;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=b),"https://js.arcgis.com/"+e+"/"}function n(e){void 0===e&&(e=b);var n=r(e),o=t(e);if(o!==M&&3===o.major){return""+n+(o.minor<=10?"js/":"")+"esri/css/esri.css"}return n+"esri/themes/light/main.css"}function o(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function i(e,t){if(t){var r=document.querySelector(t);r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}function a(e){return document.querySelector('link[href*="'+e+'"]')}function s(e){return!e||t(e)?n(e):e}function u(e,t){var r=s(e),n=a(r);return n||(n=o(r),i(n,t)),n}function l(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function c(e,t,r){var n;r&&(n=d(e,r));var o=function(){t(e),e.removeEventListener("load",o,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",o,!1)}function d(e,t){var r=function(n){t(n.error||new Error("There was an error attempting to load "+e.src)),e.removeEventListener("error",r,!1)};return e.addEventListener("error",r,!1),r}function p(e){void 0===e&&(e={}),S=e}function f(){return document.querySelector("script[data-esri-loader]")}function m(){var e=window.require;return e&&e.on}function y(e){void 0===e&&(e={});var t={};[S,e].forEach(function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])});var n=t.version,o=t.url||r(n);return new g.Promise(function(e,r){var i=f();if(i){var a=i.getAttribute("src");a!==o?r(new Error("The ArcGIS API for JavaScript is already loaded ("+a+").")):m()?e(i):c(i,e,r)}else if(m())r(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;if(s){var d=!0===s;u(d?n:s,t.insertCssBefore)}i=l(o),c(i,function(){i.setAttribute("data-esri-loader","loaded"),e(i)},r),document.body.appendChild(i)}})}function v(e){return new g.Promise(function(t,r){var n=window.require.on("error",r);window.require(e,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.remove(),t(e)})})}function h(e,t){if(void 0===t&&(t={}),m())return v(e);var r=f(),n=r&&r.getAttribute("src");return!t.url&&n&&(t.url=n),y(t).then(function(){return v(e)})}var w="undefined"!=typeof window,g={Promise:w?window.Promise:void 0},b="4.18",M="next",S={};e.utils=g,e.loadModules=h,e.getScript=f,e.isLoaded=m,e.loadScript=y,e.setDefaultOptions=p,e.loadCss=u,Object.defineProperty(e,"__esModule",{value:!0})})},function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:"map__container"}})},o=[],i={render:n,staticRenderFns:o};t.a=i}])});
//# sourceMappingURL=ky-one-map.js.map